### Summary
Maybe there is an issue.

### Findings
- Formatting style should be improved.
- This might be wrong.
- Null dereference risk because token is accessed before user check.
